# Generated by automation script
from mlmodelscope.pytorch_agent.models.pytorch_abc import PyTorchAbstractClass

import torch
from PIL import Image
import warnings
from qai_hub_models.models.deepbox import Model
import torchvision.transforms as T

class PyTorch_Qualcomm_3D_Deep_BOX(PyTorchAbstractClass):
    def __init__(self):
        warnings.warn("The batch size should be 1.")
        self.model = Model.from_pretrained()

    def preprocess(self, input_images):
        transforms = T.Compose([
            T.Resize((224, 640)),
            T.ToTensor(),
        ])
        processed_images = []
        for image_path in input_images:
            image = Image.open(image_path).convert("RGB")
            processed_images.append(transforms(image))
        model_input = torch.stack(processed_images)
        return model_input

    def predict(self, model_input):
        return self.model(model_input)

    def postprocess(self, model_output):
        return [model_output[0]['scores'].tolist()], [model_output[0]['labels'].tolist()], [model_output[0]['boxes'].tolist()]
