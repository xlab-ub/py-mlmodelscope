# Generated by automation script
from mlmodelscope.pytorch_agent.models.pytorch_abc import PyTorchAbstractClass

from ultralytics import YOLOv10
from PIL import Image
import warnings

class PyTorch_Ultralytics_YOLOv10n(PyTorchAbstractClass):
    def __init__(self):
        warnings.warn("The batch size should be 1.")
        self.model = YOLOv10.from_pretrained('jameslahm/yolov10n')

    def preprocess(self, input_images):
        return input_images

    def predict(self, model_input):
        return self.model.predict(source=model_input, verbose=False)

    def postprocess(self, model_output):
        results = model_output[0].boxes
        scores = results.conf.tolist()
        labels = results.cls.tolist()
        boxes = results.xyxy.tolist()
        return [scores], [labels], [boxes]
