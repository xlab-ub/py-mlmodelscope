# Generated by automation script
from mlmodelscope.pytorch_agent.models.pytorch_abc import PyTorchAbstractClass

from ultralyticsplus import YOLO
from PIL import Image
import warnings

class PyTorch_Ultralytics_YOLOv8m_Table_Extraction(PyTorchAbstractClass):
    def __init__(self):
        warnings.warn("The batch size should be 1.")
        self.model = YOLO('keremberke/yolov8m-table-extraction')
        self.model.overrides['conf'] = 0.25
        self.model.overrides['iou'] = 0.45
        self.model.overrides['agnostic_nms'] = False
        self.model.overrides['max_det'] = 1000

    def preprocess(self, input_images):
        model_input = input_images
        return model_input

    def predict(self, model_input):
        return self.model.predict(model_input)

    def postprocess(self, model_output):
        result = model_output[0]
        scores = result.boxes.conf.tolist()
        labels = result.boxes.cls.tolist()
        boxes = result.boxes.xyxy.tolist()
        return [scores], [labels], [boxes]
